<div class="pa4 black-80 bg-light-gray br2 shadow-1">
  <form id="contact-form" class="measure center" onsubmit="enviarFormulario(event)">
    <fieldset id="sign_up" class="ba b--transparent ph0 mh0">
      <legend class="f4 fw6 ph0 mh0 brand-color">Fale com o Agente de IA</legend>
      <div class="mt3">
        <label class="db fw6 lh-copy f6" for="nome">Seu Nome</label>
        <input class="pa2 input-reset ba bg-white hover-bg-white w-100" type="text" name="nome" id="nome" required>
      </div>
      <div class="mt3">
        <label class="db fw6 lh-copy f6" for="email">Seu E-mail</label>
        <input class="pa2 input-reset ba bg-white hover-bg-white w-100" type="email" name="email" id="email" required>
      </div>
      <div class="mt3">
        <label class="db fw6 lh-copy f6" for="mensagem">Como posso ajudar?</label>
        <textarea class="pa2 input-reset ba bg-white hover-bg-white w-100 h4" name="mensagem" id="mensagem" required></textarea>
      </div>
    </fieldset>
    <div class="">
      <button class="b ph3 pv2 input-reset ba b--brand-color bg-brand-color white grow pointer f6 dib" type="submit" id="btn-enviar">
        Enviar Mensagem
      </button>
    </div>
    <div id="status-msg" class="mt3 dn b"></div>
  </form>
</div>

<script>
  async function enviarFormulario(e) {
    e.preventDefault();
    const btn = document.getElementById('btn-enviar');
    const status = document.getElementById('status-msg');
    
    // Feedback visual imediato
    btn.disabled = true;
    btn.innerText = "Enviando para a IA...";
    status.className = "mt3 dn"; // Esconde msg anterior

    const formData = new FormData(e.target);

    try {
      // Conecta com SEU backend no Render
      const response = await fetch("https://agente-consultoria.onrender.com/contato", {
        method: "POST",
        body: formData
      });

      if (response.ok) {
        status.innerText = "✅ Sucesso! O Agente recebeu sua mensagem.";
        status.className = "mt3 dark-green b db"; // Mostra msg verde
        e.target.reset(); // Limpa o formulário
      } else {
        throw new Error('Erro na API');
      }
    } catch (error) {
      status.innerText = "❌ Erro ao conectar. Tente novamente.";
      status.className = "mt3 dark-red b db"; // Mostra msg vermelha
      console.error(error);
    } finally {
      btn.disabled = false;
      btn.innerText = "Enviar Mensagem";
    }
  }
</script>

<style>
  .brand-color { color: #003366; }
  .bg-brand-color { background-color: #003366; }
  .b--brand-color { border-color: #003366; }
</style>
